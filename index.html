<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AND | GLOBAL OS</title>
    <script src="https://meet.jit.si/external_api.js"></script>
    <style>
        :root { --main: #00ff88; --bg: #000; --card: rgba(26, 26, 26, 0.85); --text: #eee; }
        body { 
            margin: 0; background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; 
            display: flex; flex-direction: column; height: 100vh; overflow: hidden;
            background-size: cover; background-position: center; transition: 0.5s;
        }
        /* –ü–∞–Ω–µ–ª–∏ */
        .top-bar { display: flex; justify-content: space-between; padding: 10px 15px; background: rgba(0,0,0,0.7); backdrop-filter: blur(10px); border-bottom: 1px solid #333; z-index: 100; }
        #clock { font-size: 18px; font-weight: bold; color: var(--main); font-family: monospace; }
        
        .nav { display: flex; background: rgba(17, 17, 17, 0.9); border-bottom: 1px solid #333; overflow-x: auto; scrollbar-width: none; flex-shrink: 0; }
        .nav-btn { flex: 0 0 auto; padding: 15px; font-size: 11px; font-weight: bold; cursor: pointer; color: #777; text-transform: uppercase; }
        .nav-btn.active { color: var(--main); border-bottom: 2px solid var(--main); }

        .container { flex: 1; overflow-y: auto; padding: 10px; padding-bottom: 30px; }
        .box { background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #444; backdrop-filter: blur(5px); }
        
        input, textarea { width: 100%; padding: 12px; background: rgba(0,0,0,0.6); border: 1px solid #444; color: #fff; border-radius: 8px; box-sizing: border-box; margin-bottom: 10px; outline: none; font-size: 16px; }
        .btn { background: var(--main); color: #000; border: none; padding: 14px; width: 100%; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 14px; }

        /* –ò–≥—Ä–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */
        #game-canvas { background: #000; display: block; margin: 0 auto; border: 2px solid #333; border-radius: 8px; width: 100%; max-width: 300px; height: auto; aspect-ratio: 1/1; touch-action: none; }
        .mobile-controls { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; max-width: 200px; margin: 15px auto; }
        .joy-btn { background: #333; color: #fff; padding: 15px; text-align: center; border-radius: 10px; font-size: 20px; user-select: none; }
        
        .hidden { display: none; }
        .post-time { color: var(--main); font-size: 10px; }
        
        .calc-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; }
        .btn-c { background: #333; padding: 15px; border-radius: 8px; text-align: center; font-weight: bold; }
    </style>
</head>
<body>

<div class="top-bar">
    <div id="clock">00:00:00</div>
    <div id="weather-info">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
</div>

<div class="nav">
    <div class="nav-btn active" onclick="show('feed')">–õ–ï–ù–¢–ê üì±</div>
    <div class="nav-btn" onclick="show('tools')">–ò–ù–°–¢–†–£–ú–ï–ù–¢–´ üßÆ</div>
    <div class="nav-btn" onclick="show('game')">–ò–ì–†–´ üéÆ</div>
    <div class="nav-btn" onclick="show('chat')">–ß–ê–¢ üí¨</div>
    <div class="nav-btn" onclick="show('settings')">‚öôÔ∏è</div>
</div>

<div class="container">
    <div id="p-feed">
        <div class="box">
            <input type="text" id="find" placeholder="üîç –ü–æ–∏—Å–∫..." oninput="draw()">
            <textarea id="txt" placeholder="–ß—Ç–æ –Ω–æ–≤–æ–≥–æ?" rows="2"></textarea>
            <button class="btn" onclick="add()">–û–ü–£–ë–õ–ò–ö–û–í–ê–¢–¨</button>
        </div>
        <div id="wall"></div>
    </div>

    <div id="p-tools" class="hidden">
        <div class="box">
            <h3>üìÖ –ö–ê–õ–ï–ù–î–ê–†–¨</h3>
            <div id="calendar" style="text-align:center; padding: 10px; background: #222; border-radius: 8px;"></div>
        </div>
        <div class="box">
            <h3>üßÆ –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†</h3>
            <input type="text" id="calc-display" readonly>
            <div class="calc-grid">
                <div class="btn-c" onclick="calcClear()">C</div><div class="btn-c" onclick="calcIn('/')">/</div><div class="btn-c" onclick="calcIn('*')">*</div><div class="btn-c" onclick="calcRes()" style="background:var(--main);color:#000">=</div>
                <div class="btn-c" onclick="calcIn('7')">7</div><div class="btn-c" onclick="calcIn('8')">8</div><div class="btn-c" onclick="calcIn('9')">9</div><div class="btn-c" onclick="calcIn('-')">-</div>
                <div class="btn-c" onclick="calcIn('4')">4</div><div class="btn-c" onclick="calcIn('5')">5</div><div class="btn-c" onclick="calcIn('6')">6</div><div class="btn-c" onclick="calcIn('+')">+</div>
                <div class="btn-c" onclick="calcIn('1')">1</div><div class="btn-c" onclick="calcIn('2')">2</div><div class="btn-c" onclick="calcIn('3')">3</div><div class="btn-c" onclick="calcIn('0')">0</div>
            </div>
        </div>
    </div>

    <div id="p-game" class="hidden">
        <div class="box">
            <canvas id="game-canvas" width="300" height="300"></canvas>
            <div class="mobile-controls">
                <div></div><div class="joy-btn" onclick="setDir(0, -10)">‚ñ≤</div><div></div>
                <div class="joy-btn" onclick="setDir(-10, 0)">‚óÄ</div><div class="joy-btn" onclick="setDir(0, 10)">‚ñº</div><div class="joy-btn" onclick="setDir(10, 0)">‚ñ∂</div>
            </div>
            <button class="btn" onclick="startGame()">–ò–ì–†–ê–¢–¨ / –°–¢–ê–†–¢</button>
        </div>
    </div>

    <div id="p-chat" class="hidden"><div class="box"><h3>–ß–ê–¢</h3><input type="text" id="chat-room" placeholder="–ö–æ–º–Ω–∞—Ç–∞"><button class="btn" onclick="startJ()">–í–û–ô–¢–ò</button><div id="chat-f"></div></div></div>
    
    <div id="p-settings" class="hidden">
        <div class="box">
            <h3>–û–ë–û–ò</h3>
            <input type="text" id="bg-url" placeholder="URL —Ñ–æ—Ç–æ...">
            <button class="btn" onclick="changeBg()">–°–û–•–†–ê–ù–ò–¢–¨</button>
        </div>
    </div>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('posts_db')) || [];
    let snake, food, dx, dy, gameInterval;
    const canvas = document.getElementById('game-canvas');
    const ctx = canvas.getContext('2d');

    // --- –ó–ú–ï–ô–ö–ê ---
    function setDir(x, y) { if(x !== -dx || y !== -dy) { dx = x; dy = y; } }
    
    function startGame() {
        clearInterval(gameInterval);
        snake = [{x: 150, y: 150}]; food = {x: 80, y: 80}; dx = 10; dy = 0;
        gameInterval = setInterval(() => {
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};
            snake.unshift(head);
            if(head.x===food.x && head.y===food.y) {
                food = {x: Math.floor(Math.random()*29)*10, y: Math.floor(Math.random()*29)*10};
            } else { snake.pop(); }
            if(head.x<0 || head.x>=300 || head.y<0 || head.y>=300) return clearInterval(gameInterval);
            ctx.fillStyle = '#000'; ctx.fillRect(0,0,300,300);
            ctx.fillStyle = '#00ff88'; snake.forEach(s => ctx.fillRect(s.x, s.y, 9, 9));
            ctx.fillStyle = '#f00'; ctx.fillRect(food.x, food.y, 9, 9);
        }, 120);
    }

    // –°–≤–∞–π–ø—ã –¥–ª—è –º–æ–±–∏–ª–æ–∫
    let ts;
    canvas.addEventListener('touchstart', e => { ts = [e.touches[0].clientX, e.touches[0].clientY]; });
    canvas.addEventListener('touchend', e => {
        let te = [e.changedTouches[0].clientX, e.changedTouches[0].clientY];
        let x = ts[0]-te[0], y = ts[1]-te[1];
        if(Math.abs(x)>Math.abs(y)) setDir(x>0?-10:10, 0); else setDir(0, y>0?-10:10);
    });

    // --- –û–ë–©–ï–ï ---
    function show(id) {
        document.querySelectorAll('.container > div').forEach(d => d.classList.add('hidden'));
        document.getElementById('p-'+id).classList.remove('hidden');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        event.currentTarget.classList.add('active');
        if(id === 'tools') updateCal();
    }

    function updateCal() {
        const d = new Date();
        document.getElementById('calendar').innerText = d.toLocaleDateString('ru-RU', {weekday:'long', day:'numeric', month:'long'});
    }

    function add() {
        let t = document.getElementById('txt'); if(!t.value.trim()) return;
        db.unshift({t: t.value, d: new Date().toLocaleTimeString()});
        t.value = ''; localStorage.setItem('posts_db', JSON.stringify(db)); draw();
    }

    function draw() {
        let q = document.getElementById('find').value.toLowerCase();
        document.getElementById('wall').innerHTML = db.filter(x => x.t.toLowerCase().includes(q))
            .map(x => `<div class="box"><span class="post-time">${x.d}</span><br>${x.t}</div>`).join('');
    }

    function calcIn(v) { document.getElementById('calc-display').value += v; }
    function calcClear() { document.getElementById('calc-display').value = ''; }
    function calcRes() { try { let d = document.getElementById('calc-display'); d.value = eval(d.value); } catch { d.value = 'Error'; } }

    function updateClock() { document.getElementById('clock').innerText = new Date().toLocaleTimeString(); }
    setInterval(updateClock, 1000); updateClock();

    window.onload = () => {
        let bg = localStorage.getItem('user_bg');
        if(bg) document.body.style.backgroundImage = `url('${bg}')`;
        draw();
    };

    function changeBg() {
        let u = document.getElementById('bg-url').value;
        if(u) { document.body.style.backgroundImage = `url('${u}')`; localStorage.setItem('user_bg', u); }
    }
</script>
</body>
</html>
