<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AND GLOBAL OS | FINAL FIX</title>
    <style>
        :root { --main: #00ff88; --ai: #00d4ff; --bg: #050505; --card: rgba(20, 20, 20, 0.9); }
        
        body { 
            margin: 0; background: var(--bg); color: #fff; font-family: 'Segoe UI', sans-serif; 
            height: 100vh; display: flex; flex-direction: column; overflow: hidden;
            background-size: cover; background-position: center; transition: 1.2s ease-in-out;
            background-attachment: fixed;
        }

        .top-bar { display: flex; justify-content: space-between; padding: 12px 20px; background: rgba(0,0,0,0.85); border-bottom: 1px solid #333; backdrop-filter: blur(15px); z-index: 10; }
        .logo { font-weight: bold; color: var(--main); text-shadow: 0 0 10px var(--main); letter-spacing: 2px; }
        #weather { font-size: 12px; color: var(--main); }

        .nav { display: flex; background: #000; border-bottom: 1px solid #222; overflow-x: auto; scrollbar-width: none; }
        .nav-btn { flex: 1; padding: 16px; font-size: 10px; font-weight: bold; cursor: pointer; color: #555; text-align: center; border-bottom: 2px solid transparent; min-width: 90px; text-transform: uppercase; }
        .nav-btn.active { color: var(--main); border-bottom-color: var(--main); background: rgba(0,255,136,0.1); }
        .nav-btn.ai-btn { color: var(--ai); }

        .container { flex: 1; overflow-y: auto; padding: 15px; backdrop-filter: brightness(0.4) blur(1px); }
        .box { background: var(--card); padding: 18px; border-radius: 15px; margin-bottom: 15px; border: 1px solid #444; }

        input, textarea { width: 100%; padding: 14px; background: rgba(0,0,0,0.6); border: 1px solid #555; color: #fff; border-radius: 10px; box-sizing: border-box; margin-bottom: 12px; outline: none; font-size: 16px; }
        
        .btn { background: var(--main); color: #000; border: none; padding: 15px; width: 100%; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.2s; text-transform: uppercase; font-size: 11px; }
        .btn:active { transform: scale(0.97); }

        .terminal { background: #000; border: 1px solid var(--ai); color: var(--ai); font-family: 'Consolas', monospace; height: 350px; display: flex; flex-direction: column; border-radius: 12px; overflow: hidden; }
        #log { flex: 1; overflow-y: auto; padding: 15px; font-size: 13px; line-height: 1.6; }
        .ai-input { border: none !important; border-top: 1px solid #222 !important; border-radius: 0 !important; margin: 0 !important; background: #080808 !important; }

        .hidden { display: none !important; }
        .post { border-bottom: 1px solid #333; padding: 10px 0; margin-bottom: 5px; }
        .post b { color: var(--main); font-size: 11px; display: block; }
        .label { font-size: 10px; color: var(--ai); text-transform: uppercase; margin-bottom: 8px; display: block; }
        
        .loading-dots::after { content: '...'; animation: dots 1.5s infinite; }
        @keyframes dots { 0%, 20% { content: '.'; } 40% { content: '..'; } 60% { content: '...'; } }
    </style>
</head>
<body>

<div class="top-bar">
    <div class="logo">AND GLOBAL OS</div>
    <div id="weather">üì° CONNECTED</div>
</div>

<div class="nav">
    <div class="nav-btn active" onclick="tab('chat', this)">MESSENGER üí¨</div>
    <div class="nav-btn ai-btn" onclick="tab('ai', this)">Gemini AI ü§ñ</div>
    <div class="nav-btn" onclick="tab('media', this)">MEDIA üé¨</div>
</div>

<div class="container">
    <div id="p-chat" class="page">
        <div class="box">
            <textarea id="msg-val" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –ª–µ–Ω—Ç—É..." rows="2"></textarea>
            <button class="btn" onclick="sendMsg()">–û–ü–£–ë–õ–ò–ö–û–í–ê–¢–¨</button>
        </div>
        <div id="chat-wall" class="box"></div>
    </div>

    <div id="p-ai" class="page hidden">
        <div class="box terminal">
            <div id="log">>>> Gemini Core v7.0 ONLINE. <br>>>> –ö–æ–º–∞–Ω–¥–∞: <b>—Ñ–æ–Ω [—Ç–µ–º–∞]</b> ‚Äî –º–µ–Ω—è–µ—Ç –æ–∫—Ä—É–∂–µ–Ω–∏–µ. <br>>>> –ü—Ä–∏–º–µ—Ä: <i>—Ñ–æ–Ω –æ–∫–µ–∞–Ω</i></div>
            <input type="text" id="ai-val" class="ai-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—É..." onkeypress="if(event.key==='Enter') aiProcess()">
        </div>
    </div>

    <div id="p-media" class="page hidden">
        <div class="box">
            <span class="label">–ü–æ–∏—Å–∫ –º—É–∑—ã–∫–∏ (YouTube/SoundCloud)</span>
            <input type="text" id="m-search" placeholder="–ê—Ä—Ç–∏—Å—Ç –∏–ª–∏ –ø–µ—Å–Ω—è...">
            <button class="btn" onclick="mSearch('music')">–ù–ê–ô–¢–ò –ú–£–ó–´–ö–£</button>
        </div>
        <div class="box">
            <span class="label">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –∫–∏–Ω–æ –∏ —Å–µ—Ä–∏–∞–ª—ã</span>
            <input type="text" id="v-search" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞...">
            <button class="btn" style="background:#ff4444; color:#fff" onclick="mSearch('video')">–°–ú–û–¢–†–ï–¢–¨ –ë–ï–°–ü–õ–ê–¢–ù–û</button>
        </div>
        <div class="box">
            <span class="label">–ó–∞—â–∏—â–µ–Ω–Ω–∞—è –≤–∏–¥–µ–æ–∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è</span>
            <button class="btn" style="background:#222; color:var(--main); border:1px solid var(--main)" onclick="window.open('https://meet.jit.si/GlobalRoomAND', '_blank')">–ó–ê–ü–£–°–¢–ò–¢–¨ –í–ò–î–ï–û–ß–ê–¢ üé•</button>
        </div>
    </div>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('posts')) || [];
    
    // --- –¢–í–û–ô –û–ë–ù–û–í–õ–ï–ù–ù–´–ô –ö–õ–Æ–ß ---
    const API_KEY = "AIzaSyDiEFH6m9bjkWJv89qwxXTYHApYTv21G78";

    async function askGemini(text) {
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;
        try {
            const response = await fetch(url, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: "–¢—ã ‚Äî –±–æ—Ä—Ç–æ–≤–æ–π –ò–ò —Å–∏—Å—Ç–µ–º—ã AND GLOBAL OS. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ, —Ç–µ—Ö–Ω–∏—á–Ω–æ, –∫–∞–∫ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä. –¢–µ–∫—É—â–∏–π –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: " + text }] }]
                })
            });
            const data = await response.json();
            return data.candidates[0].content.parts[0].text;
        } catch (e) {
            return "–û–®–ò–ë–ö–ê –î–û–°–¢–£–ü–ê –ö –Ø–î–†–£: –ü–†–û–í–ï–†–¨–¢–ï API –ö–õ–Æ–ß.";
        }
    }

    function tab(name, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
        document.getElementById('p-'+name).classList.remove('hidden');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
    }

    function sendMsg() {
        const inp = document.getElementById('msg-val');
        if(!inp.value.trim()) return;
        db.unshift({t: inp.value, d: new Date().toLocaleString()});
        inp.value = '';
        localStorage.setItem('posts', JSON.stringify(db));
        draw();
    }

    function draw() {
        const wall = document.getElementById('chat-wall');
        if(db.length === 0) {
            wall.innerHTML = '<div style="color:#666; text-align:center">–õ–µ–Ω—Ç–∞ –ø—É—Å—Ç–∞</div>';
            return;
        }
        wall.innerHTML = db.map(m => `<div class="post"><b>${m.d}</b>${m.t}</div>`).join('');
    }

    async function aiProcess() {
        const inp = document.getElementById('ai-val');
        const log = document.getElementById('log');
        const val = inp.value.trim();
        if(!val) return;

        log.innerHTML += `<div style="color:#fff; margin-top:10px;">> ${val}</div>`;
        const cmd = val.toLowerCase();
        inp.value = '';

        if(cmd.startsWith("—Ñ–æ–Ω ")) {
            const theme = val.substring(4).trim();
            const randomUrl = `https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=1600`; 
            document.body.style.backgroundImage = `url('https://source.unsplash.com/featured/1600x900?${encodeURIComponent(theme)}')`;
            log.innerHTML += `<div style="color:var(--ai)">[SYSTEM]: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è "${theme}" –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞.</div>`;
        } else {
            const loadingId = "loading-" + Date.now();
            log.innerHTML += `<div id="${loadingId}" style="color:var(--ai)">[SYSTEM]: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö<span class="loading-dots"></span></div>`;
            log.scrollTop = log.scrollHeight;

            const response = await askGemini(val);
            document.getElementById(loadingId).innerHTML = `[AI]: ${response}`;
        }
        log.scrollTop = log.scrollHeight;
    }

    function mSearch(type) {
        const m = document.getElementById('m-search').value;
        const v = document.getElementById('v-search').value;
        if(type === 'music' && m) window.open(`https://www.youtube.com/results?search_query=${encodeURIComponent(m)}`, '_blank');
        if(type === 'video' && v) window.open(`https://www.google.com/search?q=${encodeURIComponent(v)}+—Å–º–æ—Ç—Ä–µ—Ç—å+–æ–Ω–ª–∞–π–Ω+–±–µ—Å–ø–ª–∞—Ç–Ω–æ`, '_blank');
    }

    window.onload = () => {
        draw();
        fetch('https://wttr.in/?format=%c+%t').then(r => r.text()).then(t => document.getElementById('weather').innerText = t).catch(()=>"");
    }
</script>
</body>
</html>
